<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>International Trade Document Flow - KTDDE Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
        }
        
        .scenario-info {
            background: #f0f9ff;
            border-left: 4px solid #3b82f6;
            padding: 20px;
            margin: 20px;
            border-radius: 8px;
        }
        
        .scenario-info h2 {
            color: #1e3a8a;
            margin-bottom: 15px;
        }
        
        .scenario-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .detail-item {
            display: flex;
            align-items: start;
            gap: 10px;
        }
        
        .detail-label {
            font-weight: 600;
            color: #1e3a8a;
            min-width: 100px;
        }
        
        .detail-value {
            color: #374151;
        }
        
        .nav-tabs {
            display: flex;
            background: #1e3a8a;
            overflow-x: auto;
            padding: 0 20px;
        }
        
        .nav-tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 1em;
            font-weight: 500;
            color: #93c5fd;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            white-space: nowrap;
        }
        
        .nav-tab:hover {
            color: white;
            background: rgba(255,255,255,0.1);
        }
        
        .nav-tab.active {
            color: white;
            border-bottom-color: #60a5fa;
            background: rgba(255,255,255,0.1);
        }
        
        .actor-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            padding: 20px;
            background: #f9fafb;
        }
        
        .actor-tab {
            padding: 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .actor-tab:hover {
            border-color: #3b82f6;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
        }
        
        .actor-tab.active {
            border-color: #3b82f6;
            background: linear-gradient(135deg, #dbeafe 0%, #eff6ff 100%);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }
        
        .actor-icon {
            font-size: 2.5em;
            display: block;
            margin-bottom: 10px;
        }
        
        .actor-name {
            font-size: 1.1em;
            font-weight: 600;
            color: #1e3a8a;
            display: block;
            margin-bottom: 5px;
        }
        
        .actor-tab small {
            color: #6b7280;
            display: block;
            font-size: 0.85em;
        }
        
        .content {
            padding: 30px;
            min-height: 400px;
        }
        
        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .document-card {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .document-card:hover {
            border-color: #3b82f6;
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.15);
        }
        
        .doc-icon {
            font-size: 3em;
            margin-bottom: 15px;
        }
        
        .doc-title {
            font-size: 1.1em;
            font-weight: 600;
            color: #1e3a8a;
            margin-bottom: 10px;
        }
        
        .doc-description {
            color: #6b7280;
            font-size: 0.9em;
        }
        
        .timeline-view {
            position: relative;
            padding: 20px 0;
        }
        
        .timeline-event {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 25px;
            padding: 15px;
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .timeline-event.clickable {
            cursor: pointer;
        }
        
        .timeline-event.clickable:hover {
            background: #f0f9ff;
            transform: translateX(5px);
        }
        
        .timeline-date {
            min-width: 120px;
            font-weight: 600;
            color: #1e3a8a;
            font-size: 0.9em;
        }
        
        .timeline-marker {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #3b82f6;
            border: 4px solid #dbeafe;
            flex-shrink: 0;
        }
        
        .timeline-content {
            flex: 1;
        }
        
        .timeline-content strong {
            display: block;
            color: #1f2937;
            margin-bottom: 5px;
        }
        
        .timeline-content small {
            color: #6b7280;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal-content {
            background: white;
            border-radius: 16px;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }
        
        .modal-header {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            padding: 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-header h2 {
            font-size: 1.5em;
        }
        
        .close-button {
            background: none;
            border: none;
            color: white;
            font-size: 1.8em;
            cursor: pointer;
            opacity: 0.8;
            transition: opacity 0.3s;
        }
        
        .close-button:hover {
            opacity: 1;
        }
        
        .modal-body {
            padding: 30px;
        }
        
        .json-display {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Courier New', Courier, monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }
        
        .json-key {
            color: #9cdcfe;
        }
        
        .json-string {
            color: #ce9178;
        }
        
        .json-number {
            color: #b5cea8;
        }
        
        .json-boolean {
            color: #569cd6;
        }
        
        .json-null {
            color: #569cd6;
        }
        
        .no-docs {
            text-align: center;
            color: #6b7280;
            padding: 40px;
            font-size: 1.1em;
        }
        
        .view-section {
            display: none;
        }
        
        .view-section.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }
            
            .scenario-details {
                grid-template-columns: 1fr;
            }
            
            .documents-grid {
                grid-template-columns: 1fr;
            }
            
            .actor-tabs {
                grid-template-columns: 1fr;
            }
        }
    
        /* Document Flow Styles */
        .flow-stages {
            display: flex;
            align-items: flex-start;
            gap: 20px;
            padding: 20px;
            overflow-x: auto;
            min-height: 600px;
        }
        
        .flow-stage {
            min-width: 350px;
            flex-shrink: 0;
        }
        
        .stage-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            border-radius: 12px;
        }
        
        .stage-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            color: #1e3a8a;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.3em;
            flex-shrink: 0;
        }
        
        .stage-header h3 {
            margin: 0 0 5px 0;
            font-size: 1.1em;
        }
        
        .stage-header p {
            margin: 0;
            font-size: 0.85em;
            opacity: 0.9;
        }
        
        .stage-docs {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .flow-doc {
            background: white;
            border: 3px solid #e5e7eb;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            overflow: hidden;
        }
        
        .flow-doc:hover {
            transform: translateX(5px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .flow-doc-header {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            color: white;
        }
        
        .flow-doc-number {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            background: rgba(255,255,255,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9em;
        }
        
        .flow-doc-icon {
            font-size: 1.8em;
        }
        
        .flow-doc-body {
            padding: 15px;
        }
        
        .flow-doc-title {
            font-weight: 600;
            font-size: 1em;
            color: #1e3a8a;
            margin-bottom: 8px;
        }
        
        .flow-doc-creator {
            font-size: 0.85em;
            color: #6b7280;
            margin-bottom: 5px;
        }
        
        .flow-doc-action {
            font-size: 0.8em;
            color: #374151;
            font-style: italic;
        }
        
        .flow-doc-deps, .flow-doc-triggers {
            padding: 8px 15px;
            background: #f9fafb;
            border-top: 1px solid #e5e7eb;
            font-size: 0.75em;
        }
        
        .flow-doc-deps {
            color: #dc2626;
        }
        
        .flow-doc-triggers {
            color: #059669;
        }
        
        .stage-connector {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3em;
            color: #3b82f6;
            padding: 0 10px;
            flex-shrink: 0;
        }
        
        .flow-info {
            background: #f0f9ff;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .flow-info h3 {
            color: #1e3a8a;
            margin-bottom: 15px;
        }
        
        .flow-info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .flow-info-item {
            padding: 10px;
            background: white;
            border-radius: 6px;
        }
        
        .flow-info-item strong {
            display: block;
            color: #1e3a8a;
            margin-bottom: 5px;
        }
        
        .flow-dependencies, .flow-triggers {
            margin-top: 15px;
        }
        
        .flow-dependencies h4 {
            color: #dc2626;
            margin-bottom: 10px;
        }
        
        .flow-triggers h4 {
            color: #059669;
            margin-bottom: 10px;
        }
        
        .flow-dependencies ul, .flow-triggers ul {
            list-style: none;
            padding: 0;
        }
        
        .flow-dependencies li, .flow-triggers li {
            padding: 8px;
            margin: 5px 0;
            background: white;
            border-radius: 6px;
            transition: all 0.2s;
        }
        
        .flow-dependencies li:hover, .flow-triggers li:hover {
            background: #e0e7ff;
            transform: translateX(5px);
        }

    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç International Trade Document Flow</h1>
            <p class="subtitle">KTDDE-Based Digital Trade Documents Demo</p>
        </div>
        
        <div class="scenario-info">
            <h2>üì¶ Trade Scenario: Finnish Gluelam Timber to Japan</h2>
            <div class="scenario-details">
                <div class="detail-item">
                    <span class="detail-label">üè≠ Exporter:</span>
                    <span class="detail-value">Nordic Timber Oy, Kuhmo, Finland</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">üè¢ Importer:</span>
                    <span class="detail-value">Tokyo Construction Materials Ltd, Japan</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">üì¶ Product:</span>
                    <span class="detail-value">Engineered Gluelam Timber Beams (GL30c, GL32h)</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">üí∞ Value:</span>
                    <span class="detail-value">EUR 339,000 (CFR Tokyo Port)</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">‚öñÔ∏è Weight:</span>
                    <span class="detail-value">28,800 kg (160 pieces, 8 bundles)</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">üö¢ Route:</span>
                    <span class="detail-value">Rauma Port, FI ‚Üí Tokyo Port, JP (~45 days)</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">üí≥ Payment:</span>
                    <span class="detail-value">Confirmed Irrevocable L/C (60 days)</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">üìÑ Documents:</span>
                    <span class="detail-value">15 KTDDE-compliant trade documents</span>
                </div>
            </div>
        </div>
        
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showView('actors')">üë• Document Actors</button>
            <button class="nav-tab" onclick="showView('timeline')">‚è±Ô∏è Timeline</button>
            <button class="nav-tab" onclick="showView('flow')">üîÑ Document Flow</button>
        </div>
        
        <div id="actors-view" class="view-section active">
            <div id="actor-tabs" class="actor-tabs">
                <!-- Actor tabs will be dynamically generated by demo.js -->
            </div>
            
            <div class="content">
                <div id="documents-grid" class="documents-grid">
                    <!-- Documents will be dynamically generated by demo.js -->
                </div>
            </div>
        </div>
        
        
        <div id="flow-view" class="view-section">
            <div class="content">
                <div id="flow-diagram">
                    <!-- Flow diagram will be dynamically generated by demo.js -->
                </div>
            </div>
        </div>

        <div id="timeline-view" class="view-section">
            <div class="content">
                <div id="timeline-events">
                    <!-- Timeline will be dynamically generated by demo.js -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal for document details -->
    <div id="doc-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="doc-modal-title"></h2>
                <button class="close-button" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div id="doc-modal-content"></div>
            </div>
        </div>
    </div>
    
    <script>
// demo.js - Finnish Gluelam Timber to Japan Trade Demo
// All 15 relevant KTDDE documents for the trade
// WITH INTERACTIVE DOCUMENT FLOW VISUALIZATION

// Document metadata
const docInfo = {
  purchase_order: {
    title: "Purchase Order",
    icon: "üìù",
    description: "Buyer's order for gluelam timber beams"
  },
  documentary_credit: {
    title: "Documentary Credit (L/C)",
    icon: "üè¶",
    description: "Confirmed irrevocable letter of credit from MUFG Bank"
  },
  bill_of_lading: {
    title: "Bill of Lading",
    icon: "üö¢",
    description: "Ocean transport document from FESCO"
  },
  commercial_invoice: {
    title: "Commercial Invoice",
    icon: "üìÑ",
    description: "Seller's invoice for EUR 339,000"
  },
  certificate_of_origin: {
    title: "Certificate of Origin",
    icon: "üìú",
    description: "Finnish Chamber of Commerce certificate"
  },
  packing_list: {
    title: "Packing List",
    icon: "üì¶",
    description: "Detailed packing information for 8 bundles"
  },
  insurance_certificate: {
    title: "Insurance Certificate",
    icon: "üõ°Ô∏è",
    description: "All Risks marine cargo insurance"
  },
  phytosanitary_certificate: {
    title: "Phytosanitary Certificate",
    icon: "üå≤",
    description: "ISPM-15 compliant wood treatment certificate"
  },
  customs_declaration_export: {
    title: "Customs Declaration (Export)",
    icon: "üõÉ",
    description: "Finnish export customs clearance"
  },
  customs_declaration_import: {
    title: "Customs Declaration (Import)",
    icon: "üõÉ",
    description: "Japanese import customs clearance"
  },
  delivery_note: {
    title: "Delivery Note",
    icon: "üöö",
    description: "Final delivery to construction site"
  },
  regulatory_certificate: {
    title: "Regulatory Certificate (CE)",
    icon: "‚úÖ",
    description: "CE marking for structural timber (EN 14080)"
  },
  sea_cargo_manifest: {
    title: "Sea Cargo Manifest",
    icon: "üìã",
    description: "Vessel manifest for MV Baltic Express"
  },
  warehouse_receipt: {
    title: "Warehouse Receipt",
    icon: "üè≠",
    description: "Rauma Port warehouse receipt"
  },
  payment_confirmation: {
    title: "Payment Confirmation",
    icon: "üí∞",
    description: "Bank payment confirmation via L/C"
  }
};

// All documents (SHACL-based JSON)
const documents = {
  "purchase_order": {
    "@type": "PurchaseOrder",
    "purchaseOrderNumber": "4500001000",
    "issueDate": "2026-01-01",
    "buyerParty": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan",
      "country": {
        "@type": "Country",
        "countryCode": "JP"
      }
    },
    "sellerParty": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland",
      "country": {
        "@type": "Country",
        "countryCode": "FI"
      }
    },
    "deliveryTerms": {
      "@type": "TradeDeliveryTerms",
      "incoterms": "CFR",
      "namedPlace": "Tokyo Port, Japan"
    },
    "paymentTerms": {
      "@type": "PaymentTerms",
      "paymentMeans": "Letter of Credit",
      "paymentDueDate": "2026-04-06"
    },
    "goodsItems": [
      {
        "@type": "GoodsItem",
        "itemNumber": "1",
        "description": "Gluelam Beam 90x315x12000mm GL30c",
        "quantity": {
          "@type": "Quantity",
          "value": 120,
          "unitCode": "PCS"
        },
        "unitPrice": {
          "@type": "MonetaryAmount",
          "value": 1950.0,
          "currency": "EUR"
        },
        "totalAmount": {
          "@type": "MonetaryAmount",
          "value": 234000.0,
          "currency": "EUR"
        }
      },
      {
        "@type": "GoodsItem",
        "itemNumber": "2",
        "description": "Gluelam Beam 115x405x15000mm GL32h",
        "quantity": {
          "@type": "Quantity",
          "value": 40,
          "unitCode": "PCS"
        },
        "unitPrice": {
          "@type": "MonetaryAmount",
          "value": 2625.0,
          "currency": "EUR"
        },
        "totalAmount": {
          "@type": "MonetaryAmount",
          "value": 105000.0,
          "currency": "EUR"
        }
      }
    ],
    "totalAmount": {
      "@type": "MonetaryAmount",
      "value": 339000.0,
      "currency": "EUR"
    }
  },
  "documentary_credit": {
    "@type": "DocumentaryCredit",
    "creditNumber": "LC-MUFG-FI-2024-05678",
    "issueDate": "2026-01-16",
    "expiryDate": "2026-04-16",
    "applicant": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan"
    },
    "beneficiary": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "issuingBank": {
      "@type": "Bank",
      "bankName": "MUFG Bank Tokyo",
      "swiftCode": "BOTKJPJT"
    },
    "advisingBank": {
      "@type": "Bank",
      "bankName": "Nordea Bank Finland",
      "swiftCode": "NDEAFIHH"
    },
    "creditAmount": {
      "@type": "MonetaryAmount",
      "value": 353000.0,
      "currency": "EUR"
    },
    "creditType": "Confirmed Irrevocable",
    "presentationPeriod": "21 days after shipment date",
    "documentsRequired": [
      "Commercial Invoice",
      "Bill of Lading",
      "Certificate of Origin",
      "Packing List",
      "Insurance Certificate",
      "Phytosanitary Certificate"
    ]
  },
  "bill_of_lading": {
    "@type": "BillOfLading",
    "blNumber": "FESCO2024FI123456",
    "issueDate": "2026-02-05",
    "carrierParty": {
      "@type": "Party",
      "partyName": "FESCO (Far Eastern Shipping Company)"
    },
    "shipperParty": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "consigneeParty": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan"
    },
    "notifyParty": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "contactInfo": "procurement@tokyoconstruction.jp"
    },
    "portOfLoading": {
      "@type": "Location",
      "locationName": "Rauma Port",
      "countryCode": "FI"
    },
    "portOfDischarge": {
      "@type": "Location",
      "locationName": "Tokyo Port",
      "countryCode": "JP"
    },
    "vessel": "MV Baltic Express",
    "voyageNumber": "V2024-FI-123",
    "goodsDescription": "Engineered Gluelam Timber Beams",
    "numberOfPackages": 8,
    "grossWeight": {
      "@type": "Quantity",
      "value": 30400,
      "unitCode": "KGM"
    },
    "volume": {
      "@type": "Quantity",
      "value": 68.80000000000001,
      "unitCode": "MTQ"
    },
    "freightPayable": "Prepaid",
    "deliveryTerms": "CFR Tokyo Port"
  },
  "commercial_invoice": {
    "@type": "CommercialInvoice",
    "invoiceNumber": "9000002000",
    "issueDate": "2026-02-05",
    "sellerParty": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland",
      "vatNumber": "FI12345678"
    },
    "buyerParty": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan",
      "taxId": "JP9876543210"
    },
    "invoiceLines": [
      {
        "@type": "InvoiceLine",
        "lineNumber": "1",
        "productDescription": "Gluelam Beam 90x315x12000mm GL30c",
        "hsCode": "4418.91",
        "quantity": {
          "@type": "Quantity",
          "value": 120,
          "unitCode": "PCS"
        },
        "unitPrice": {
          "@type": "MonetaryAmount",
          "value": 1950.0,
          "currency": "EUR"
        },
        "lineTotal": {
          "@type": "MonetaryAmount",
          "value": 234000.0,
          "currency": "EUR"
        }
      },
      {
        "@type": "InvoiceLine",
        "lineNumber": "2",
        "productDescription": "Gluelam Beam 115x405x15000mm GL32h",
        "hsCode": "4418.91",
        "quantity": {
          "@type": "Quantity",
          "value": 40,
          "unitCode": "PCS"
        },
        "unitPrice": {
          "@type": "MonetaryAmount",
          "value": 2625.0,
          "currency": "EUR"
        },
        "lineTotal": {
          "@type": "MonetaryAmount",
          "value": 105000.0,
          "currency": "EUR"
        }
      }
    ],
    "subtotal": {
      "@type": "MonetaryAmount",
      "value": 339000.0,
      "currency": "EUR"
    },
    "freightCharges": {
      "@type": "MonetaryAmount",
      "value": 12000.0,
      "currency": "EUR"
    },
    "totalAmount": {
      "@type": "MonetaryAmount",
      "value": 351000.0,
      "currency": "EUR"
    },
    "paymentTerms": "Letter of Credit No. LC-MUFG-FI-2024-05678",
    "deliveryTerms": "CFR Tokyo Port",
    "referenceBL": "FESCO2024FI123456",
    "referenceLC": "LC-MUFG-FI-2024-05678"
  },
  "certificate_of_origin": {
    "@type": "CertificateOfOrigin",
    "certificateNumber": "COO-FI-2024-0234",
    "issueDate": "2026-02-05",
    "issuingAuthority": {
      "@type": "Party",
      "partyName": "Finnish Chamber of Commerce",
      "postalAddress": "Helsinki, Finland"
    },
    "exporter": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "consignee": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan"
    },
    "countryOfOrigin": {
      "@type": "Country",
      "countryCode": "FI",
      "countryName": "Finland"
    },
    "goodsDescription": "Engineered Gluelam Timber Beams (GL30c, GL32h)",
    "hsCode": "4418.91",
    "referenceBL": "FESCO2024FI123456",
    "referenceInvoice": "9000002000"
  },
  "packing_list": {
    "@type": "PackingList",
    "packingListNumber": "PL-2024-0567",
    "issueDate": "2026-02-05",
    "shipper": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "consignee": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan"
    },
    "packages": [
      {
        "@type": "Package",
        "packageNumber": "BUNDLE-001",
        "packageType": "Timber Bundle",
        "contents": "Gluelam Beam 90x315x12000mm GL30c (x30)",
        "grossWeight": {
          "@type": "Quantity",
          "value": 3800.0,
          "unitCode": "KGM"
        },
        "dimensions": "Strapped timber bundle"
      },
      {
        "@type": "Package",
        "packageNumber": "BUNDLE-002",
        "packageType": "Timber Bundle",
        "contents": "Gluelam Beam 115x405x15000mm GL32h (x10)",
        "grossWeight": {
          "@type": "Quantity",
          "value": 3800.0,
          "unitCode": "KGM"
        },
        "dimensions": "Strapped timber bundle"
      },
      {
        "@type": "Package",
        "packageNumber": "BUNDLE-003",
        "packageType": "Timber Bundle",
        "contents": "Gluelam Beam 90x315x12000mm GL30c (x30)",
        "grossWeight": {
          "@type": "Quantity",
          "value": 3800.0,
          "unitCode": "KGM"
        },
        "dimensions": "Strapped timber bundle"
      },
      {
        "@type": "Package",
        "packageNumber": "BUNDLE-004",
        "packageType": "Timber Bundle",
        "contents": "Gluelam Beam 115x405x15000mm GL32h (x10)",
        "grossWeight": {
          "@type": "Quantity",
          "value": 3800.0,
          "unitCode": "KGM"
        },
        "dimensions": "Strapped timber bundle"
      },
      {
        "@type": "Package",
        "packageNumber": "BUNDLE-005",
        "packageType": "Timber Bundle",
        "contents": "Gluelam Beam 90x315x12000mm GL30c (x30)",
        "grossWeight": {
          "@type": "Quantity",
          "value": 3800.0,
          "unitCode": "KGM"
        },
        "dimensions": "Strapped timber bundle"
      },
      {
        "@type": "Package",
        "packageNumber": "BUNDLE-006",
        "packageType": "Timber Bundle",
        "contents": "Gluelam Beam 115x405x15000mm GL32h (x10)",
        "grossWeight": {
          "@type": "Quantity",
          "value": 3800.0,
          "unitCode": "KGM"
        },
        "dimensions": "Strapped timber bundle"
      },
      {
        "@type": "Package",
        "packageNumber": "BUNDLE-007",
        "packageType": "Timber Bundle",
        "contents": "Gluelam Beam 90x315x12000mm GL30c (x30)",
        "grossWeight": {
          "@type": "Quantity",
          "value": 3800.0,
          "unitCode": "KGM"
        },
        "dimensions": "Strapped timber bundle"
      },
      {
        "@type": "Package",
        "packageNumber": "BUNDLE-008",
        "packageType": "Timber Bundle",
        "contents": "Gluelam Beam 115x405x15000mm GL32h (x10)",
        "grossWeight": {
          "@type": "Quantity",
          "value": 3800.0,
          "unitCode": "KGM"
        },
        "dimensions": "Strapped timber bundle"
      }
    ],
    "totalGrossWeight": {
      "@type": "Quantity",
      "value": 30400,
      "unitCode": "KGM"
    },
    "totalNetWeight": {
      "@type": "Quantity",
      "value": 29792.0,
      "unitCode": "KGM"
    },
    "totalVolume": {
      "@type": "Quantity",
      "value": 68.80000000000001,
      "unitCode": "MTQ"
    },
    "referenceBL": "FESCO2024FI123456",
    "referenceInvoice": "9000002000"
  },
  "insurance_certificate": {
    "@type": "InsuranceCertificate",
    "certificateNumber": "INS-FESCO-2024-1234",
    "issueDate": "2026-02-03",
    "insurer": {
      "@type": "Party",
      "partyName": "Nordic Marine Insurance AS",
      "postalAddress": "Oslo, Norway"
    },
    "insured": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "policyNumber": "NMI-2024-TIMBER-5678",
    "insuredAmount": {
      "@type": "MonetaryAmount",
      "value": 388300.00000000006,
      "currency": "EUR"
    },
    "coverage": "All Risks (Institute Cargo Clauses A)",
    "goodsDescription": "Gluelam Timber Beams - 160 PCS total",
    "voyage": "Rauma Port, Finland to Tokyo Port, Japan",
    "vessel": "MV Baltic Express",
    "referenceBL": "FESCO2024FI123456"
  },
  "phytosanitary_certificate": {
    "@type": "PhytosanitaryCertificate",
    "certificateNumber": "PHY-FI-2024-00891",
    "issueDate": "2026-02-04",
    "issuingAuthority": {
      "@type": "Party",
      "partyName": "Finnish Food Authority - Plant Health Unit",
      "postalAddress": "Helsinki, Finland"
    },
    "exporter": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "consignee": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan"
    },
    "placeOfOrigin": "Finland - Kainuu Region",
    "declaredMeansOfConveyance": "Sea Freight - Container",
    "pointOfEntry": "Tokyo Port, Japan",
    "botanicalName": "Picea abies (Norway Spruce), Pinus sylvestris (Scots Pine)",
    "treatment": "Heat treatment ISPM-15 compliant, Kiln dried to 12% moisture content",
    "disinfestationMethod": "HT (Heat Treatment) 56¬∞C for 30 minutes",
    "additionalDeclaration": "Wood products free from bark, treated according to ISPM-15 standard",
    "inspectionDate": "2026-02-03",
    "inspectorName": "Dr. Matti Virtanen"
  },
  "customs_declaration_export": {
    "@type": "CustomsDeclaration",
    "declarationNumber": "FI-EXP-2024-123456",
    "declarationType": "Export Declaration",
    "declarationDate": "2026-02-05",
    "declarant": {
      "@type": "Party",
      "partyName": "Baltic Logistics Oy",
      "postalAddress": "Satamakatu 8, 26100 Rauma, Finland"
    },
    "exporter": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland",
      "eoriNumber": "FIFI12345678"
    },
    "importer": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan"
    },
    "customsOffice": {
      "@type": "CustomsOffice",
      "officeName": "Finnish Customs - Rauma",
      "officeCode": "FI-RAU-001"
    },
    "goodsItems": [
      {
        "@type": "GoodsItem",
        "itemNumber": "1",
        "description": "Gluelam Beam 90x315x12000mm GL30c",
        "hsCode": "4418.91",
        "origin": "FI",
        "quantity": {
          "@type": "Quantity",
          "value": 120,
          "unitCode": "PCS"
        },
        "value": {
          "@type": "MonetaryAmount",
          "value": 234000.0,
          "currency": "EUR"
        }
      },
      {
        "@type": "GoodsItem",
        "itemNumber": "2",
        "description": "Gluelam Beam 115x405x15000mm GL32h",
        "hsCode": "4418.91",
        "origin": "FI",
        "quantity": {
          "@type": "Quantity",
          "value": 40,
          "unitCode": "PCS"
        },
        "value": {
          "@type": "MonetaryAmount",
          "value": 105000.0,
          "currency": "EUR"
        }
      }
    ],
    "totalInvoiceAmount": {
      "@type": "MonetaryAmount",
      "value": 339000.0,
      "currency": "EUR"
    },
    "destinationCountry": "JP",
    "exportProcedure": "10 - Permanent export",
    "referenceBL": "FESCO2024FI123456",
    "referenceInvoice": "9000002000"
  },
  "customs_declaration_import": {
    "@type": "CustomsDeclaration",
    "declarationNumber": "JP-IMP-2024-987654",
    "declarationType": "Import Declaration",
    "declarationDate": "2026-03-22",
    "declarant": {
      "@type": "Party",
      "partyName": "Tokyo Customs Broker KK",
      "postalAddress": "Tokyo, Japan"
    },
    "exporter": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "importer": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan",
      "customsId": "JP9876543210"
    },
    "customsOffice": {
      "@type": "CustomsOffice",
      "officeName": "Japan Customs - Tokyo Port",
      "officeCode": "JP-TYO-PORT"
    },
    "goodsItems": [
      {
        "@type": "GoodsItem",
        "itemNumber": "1",
        "description": "Gluelam Beam 90x315x12000mm GL30c",
        "hsCode": "4418.91",
        "origin": "FI",
        "quantity": {
          "@type": "Quantity",
          "value": 120,
          "unitCode": "PCS"
        },
        "value": {
          "@type": "MonetaryAmount",
          "value": 234000.0,
          "currency": "EUR"
        }
      },
      {
        "@type": "GoodsItem",
        "itemNumber": "2",
        "description": "Gluelam Beam 115x405x15000mm GL32h",
        "hsCode": "4418.91",
        "origin": "FI",
        "quantity": {
          "@type": "Quantity",
          "value": 40,
          "unitCode": "PCS"
        },
        "value": {
          "@type": "MonetaryAmount",
          "value": 105000.0,
          "currency": "EUR"
        }
      }
    ],
    "totalInvoiceAmount": {
      "@type": "MonetaryAmount",
      "value": 351000.0,
      "currency": "EUR"
    },
    "assessedDuties": {
      "@type": "MonetaryAmount",
      "value": 0.0,
      "currency": "JPY",
      "note": "Zero duty under EU-Japan EPA"
    },
    "importProcedure": "40 - Release for free circulation",
    "preferentialTreatment": "EU-Japan Economic Partnership Agreement (EPA)",
    "referenceBL": "FESCO2024FI123456",
    "referenceInvoice": "9000002000"
  },
  "delivery_note": {
    "@type": "DeliveryNote",
    "deliveryNoteNumber": "DN-2024-0234",
    "deliveryDate": "2026-03-25",
    "supplier": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "recipient": {
      "@type": "Party",
      "partyName": "Tokyo Construction Materials Ltd",
      "postalAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan"
    },
    "deliveryAddress": "3-7-1 Koto, Koto-ku, Tokyo 135-0016, Japan - Construction Site Warehouse",
    "carrierParty": {
      "@type": "Party",
      "partyName": "Tokyo Logistics KK",
      "vehicleRegistration": "Tokyo 500 „Åü 1234"
    },
    "deliveryNoteLines": [
      {
        "@type": "DeliveryNoteLine",
        "lineNumber": "1",
        "productDescription": "Gluelam Beam 90x315x12000mm GL30c",
        "deliveredQuantity": {
          "@type": "Quantity",
          "value": 120,
          "unitCode": "PCS"
        },
        "condition": "Good"
      },
      {
        "@type": "DeliveryNoteLine",
        "lineNumber": "2",
        "productDescription": "Gluelam Beam 115x405x15000mm GL32h",
        "deliveredQuantity": {
          "@type": "Quantity",
          "value": 40,
          "unitCode": "PCS"
        },
        "condition": "Good"
      }
    ],
    "receivedBy": "Tanaka-san (Site Manager)",
    "receivedDate": "2026-03-25",
    "referencePO": "4500001000",
    "referenceBL": "FESCO2024FI123456"
  },
  "regulatory_certificate": {
    "@type": "RegulatoryCertificate",
    "certificateNumber": "CE-GL-2024-0156",
    "issueDate": "2026-01-31",
    "issuingAuthority": {
      "@type": "Party",
      "partyName": "T√úV S√úD Finland Oy",
      "postalAddress": "Helsinki, Finland"
    },
    "applicant": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "certificateType": "CE Marking - Structural Timber",
    "productDescription": "Glued laminated timber (Glulam) structural beams",
    "standard": "EN 14080:2013 - Timber structures - Glued laminated timber and glued solid timber",
    "grades": "GL30c, GL32h",
    "strengthClass": "GL30c (f_m,g,k = 30 N/mm¬≤), GL32h (f_m,g,k = 32 N/mm¬≤)",
    "testResults": "All mechanical properties compliant with EN 14080:2013",
    "factoryProductionControl": "ISO 9001:2015 certified",
    "validityPeriod": "5 years from issue date",
    "remarks": "Suitable for structural use in construction per Eurocode 5"
  },
  "sea_cargo_manifest": {
    "@type": "SeaCargoManifest",
    "manifestNumber": "FESCO-MAN-2024-FI123",
    "issueDate": "2026-02-05",
    "vessel": {
      "@type": "TransportMeans",
      "vesselName": "MV Baltic Express",
      "imoNumber": "IMO9876543",
      "flag": "Finland"
    },
    "voyage": "V2024-FI-123",
    "portOfLoading": {
      "@type": "Location",
      "locationName": "Rauma Port",
      "unlocode": "FIRAU"
    },
    "portOfDischarge": {
      "@type": "Location",
      "locationName": "Tokyo Port",
      "unlocode": "JPTYO"
    },
    "carrierParty": {
      "@type": "Party",
      "partyName": "FESCO (Far Eastern Shipping Company)"
    },
    "consignments": [
      {
        "@type": "Consignment",
        "blNumber": "FESCO2024FI123456",
        "shipper": "Nordic Timber Oy",
        "consignee": "Tokyo Construction Materials Ltd",
        "description": "Gluelam Timber Beams",
        "packages": 8,
        "weight": {
          "@type": "Quantity",
          "value": 30400,
          "unitCode": "KGM"
        },
        "volume": {
          "@type": "Quantity",
          "value": 68.80000000000001,
          "unitCode": "MTQ"
        }
      }
    ],
    "totalPackages": 8,
    "totalWeight": {
      "@type": "Quantity",
      "value": 30400,
      "unitCode": "KGM"
    }
  },
  "warehouse_receipt": {
    "@type": "WarehouseReceipt",
    "receiptNumber": "WH-RAU-2024-0567",
    "issueDate": "2026-02-02",
    "warehouse": {
      "@type": "Party",
      "partyName": "Rauma Port Warehouse Services Oy",
      "postalAddress": "Rauma Port Terminal, 26100 Rauma, Finland"
    },
    "depositor": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "postalAddress": "Mets√§katu 15, 88900 Kuhmo, Finland"
    },
    "goodsDescription": "Gluelam timber beams (160 pieces) ready for export",
    "quantity": {
      "@type": "Quantity",
      "value": 160,
      "unitCode": "PCS"
    },
    "weight": {
      "@type": "Quantity",
      "value": 30400,
      "unitCode": "KGM"
    },
    "storageLocation": "Export Warehouse Section B-12",
    "storageStartDate": "2026-02-02",
    "storageEndDate": "2026-02-05",
    "releaseCondition": "Released for shipment on B/L FESCO2024FI123456"
  },
  "payment_confirmation": {
    "@type": "PaymentConfirmation",
    "confirmationNumber": "PAY-MUFG-2024-05678",
    "paymentDate": "2026-03-02",
    "payer": {
      "@type": "Party",
      "partyName": "MUFG Bank Tokyo",
      "swiftCode": "BOTKJPJT"
    },
    "payee": {
      "@type": "Party",
      "partyName": "Nordic Timber Oy",
      "bankAccount": "FI7910001234567890",
      "swiftCode": "NDEAFIHH"
    },
    "paymentAmount": {
      "@type": "MonetaryAmount",
      "value": 351000.0,
      "currency": "EUR"
    },
    "paymentMethod": "Documentary Credit Settlement",
    "referenceDocument": "L/C No. LC-MUFG-FI-2024-05678",
    "paymentStatus": "Completed",
    "transactionId": "SWIFT-MT700-2024-05678",
    "valueDate": "2026-03-02"
  }
};

// Document IDs for reference
const docIds = {
  "purchase_order": "4500001000",
  "documentary_credit": "LC-MUFG-FI-2024-05678",
  "bill_of_lading": "FESCO2024FI123456",
  "commercial_invoice": "9000002000",
  "certificate_of_origin": "COO-FI-2024-0234",
  "packing_list": "PL-2024-0567",
  "insurance_certificate": "INS-FESCO-2024-1234",
  "phytosanitary_certificate": "PHY-FI-2024-00891",
  "customs_declaration_export": "FI-EXP-2024-123456",
  "customs_declaration_import": "JP-IMP-2024-987654",
  "delivery_note": "DN-2024-0234",
  "regulatory_certificate": "CE-GL-2024-0156",
  "sea_cargo_manifest": "FESCO-MAN-2024-FI123",
  "warehouse_receipt": "WH-RAU-2024-0567",
  "payment_confirmation": "PAY-MUFG-2024-05678"
};

// Actor views (which documents each actor sees)
const actorViews = {
  "buyer": [
    "purchase_order",
    "documentary_credit",
    "bill_of_lading",
    "commercial_invoice",
    "certificate_of_origin",
    "packing_list",
    "insurance_certificate",
    "customs_declaration_import",
    "delivery_note",
    "payment_confirmation"
  ],
  "seller": [
    "purchase_order",
    "documentary_credit",
    "bill_of_lading",
    "commercial_invoice",
    "certificate_of_origin",
    "packing_list",
    "insurance_certificate",
    "phytosanitary_certificate",
    "customs_declaration_export",
    "delivery_note",
    "regulatory_certificate",
    "warehouse_receipt",
    "payment_confirmation"
  ],
  "bank": [
    "purchase_order",
    "documentary_credit",
    "commercial_invoice",
    "bill_of_lading",
    "certificate_of_origin",
    "packing_list",
    "insurance_certificate",
    "phytosanitary_certificate",
    "payment_confirmation"
  ],
  "carrier": [
    "bill_of_lading",
    "packing_list",
    "sea_cargo_manifest",
    "phytosanitary_certificate",
    "dangerous_goods_declaration",
    "warehouse_receipt"
  ],
  "customs": [
    "commercial_invoice",
    "bill_of_lading",
    "certificate_of_origin",
    "packing_list",
    "phytosanitary_certificate",
    "customs_declaration_export",
    "customs_declaration_import"
  ],
  "chamber": [
    "certificate_of_origin",
    "commercial_invoice"
  ],
  "certifier": [
    "phytosanitary_certificate",
    "regulatory_certificate"
  ]
};

// Timeline events
const timeline = [
  {
    "date": "2026-01-01",
    "event": "Purchase Order Issued",
    "actor": "Buyer",
    "doc": "purchase_order"
  },
  {
    "date": "2026-01-16",
    "event": "Letter of Credit Opened",
    "actor": "Bank",
    "doc": "documentary_credit"
  },
  {
    "date": "2026-01-31",
    "event": "CE Certification Completed",
    "actor": "Certifier",
    "doc": "regulatory_certificate"
  },
  {
    "date": "2026-02-02",
    "event": "Goods Stored at Port Warehouse",
    "actor": "Warehouse",
    "doc": "warehouse_receipt"
  },
  {
    "date": "2026-02-03",
    "event": "Phytosanitary Inspection",
    "actor": "Authority",
    "doc": "phytosanitary_certificate"
  },
  {
    "date": "2026-02-03",
    "event": "Insurance Certificate Issued",
    "actor": "Insurer",
    "doc": "insurance_certificate"
  },
  {
    "date": "2026-02-04",
    "event": "Certificate of Origin Issued",
    "actor": "Chamber",
    "doc": "certificate_of_origin"
  },
  {
    "date": "2026-02-05",
    "event": "Goods Loaded & Shipped",
    "actor": "Carrier",
    "doc": "bill_of_lading"
  },
  {
    "date": "2026-02-05",
    "event": "Commercial Invoice Issued",
    "actor": "Seller",
    "doc": "commercial_invoice"
  },
  {
    "date": "2026-02-05",
    "event": "Packing List Created",
    "actor": "Seller",
    "doc": "packing_list"
  },
  {
    "date": "2026-02-05",
    "event": "Export Customs Clearance",
    "actor": "Customs",
    "doc": "customs_declaration_export"
  },
  {
    "date": "2026-02-05",
    "event": "Sea Cargo Manifest Filed",
    "actor": "Carrier",
    "doc": "sea_cargo_manifest"
  },
  {
    "date": "2026-03-02",
    "event": "Payment Processed",
    "actor": "Bank",
    "doc": "payment_confirmation"
  },
  {
    "date": "2026-03-22",
    "event": "Vessel Arrives Tokyo Port",
    "actor": "Carrier",
    "doc": null
  },
  {
    "date": "2026-03-22",
    "event": "Import Customs Clearance",
    "actor": "Customs",
    "doc": "customs_declaration_import"
  },
  {
    "date": "2026-03-25",
    "event": "Final Delivery to Buyer",
    "actor": "Logistics",
    "doc": "delivery_note"
  }
];

// Document flow (who creates what, dependencies, triggers)
const documentFlow = {
  "purchase_order": {
    "order": 1,
    "creator": "buyer",
    "creator_name": "Buyer (Tokyo Construction)",
    "action": "Issues Purchase Order",
    "triggers": [
      "documentary_credit"
    ],
    "dependencies": [],
    "description": "Buyer issues PO requesting 160 gluelam beams for EUR 285,000"
  },
  "documentary_credit": {
    "order": 2,
    "creator": "bank",
    "creator_name": "Buyer's Bank (MUFG Tokyo)",
    "action": "Opens Letter of Credit",
    "triggers": [
      "regulatory_certificate",
      "phytosanitary_certificate",
      "warehouse_receipt"
    ],
    "dependencies": [
      "purchase_order"
    ],
    "description": "Bank opens confirmed irrevocable L/C for EUR 339,000 valid 90 days"
  },
  "regulatory_certificate": {
    "order": 3,
    "creator": "certifier",
    "creator_name": "Certifier (T√úV S√úD)",
    "action": "Issues CE Marking Certificate",
    "triggers": [
      "warehouse_receipt"
    ],
    "dependencies": [
      "documentary_credit"
    ],
    "description": "CE certification for structural timber per EN 14080:2013"
  },
  "warehouse_receipt": {
    "order": 4,
    "creator": "seller",
    "creator_name": "Warehouse (Rauma Port)",
    "action": "Receives Goods at Port",
    "triggers": [
      "phytosanitary_certificate",
      "insurance_certificate"
    ],
    "dependencies": [
      "regulatory_certificate",
      "documentary_credit"
    ],
    "description": "Timber stored at export warehouse, ready for shipment"
  },
  "phytosanitary_certificate": {
    "order": 5,
    "creator": "certifier",
    "creator_name": "Authority (Finnish Food Authority)",
    "action": "Issues Phytosanitary Certificate",
    "triggers": [
      "insurance_certificate"
    ],
    "dependencies": [
      "warehouse_receipt"
    ],
    "description": "ISPM-15 heat treatment certification for wood products"
  },
  "insurance_certificate": {
    "order": 6,
    "creator": "seller",
    "creator_name": "Insurer (Nordic Marine Insurance)",
    "action": "Issues Insurance Certificate",
    "triggers": [
      "certificate_of_origin",
      "packing_list"
    ],
    "dependencies": [
      "phytosanitary_certificate"
    ],
    "description": "All Risks marine cargo insurance for EUR 373,000 (110% CIF)"
  },
  "certificate_of_origin": {
    "order": 7,
    "creator": "chamber",
    "creator_name": "Chamber (Finnish Chamber of Commerce)",
    "action": "Issues Certificate of Origin",
    "triggers": [
      "bill_of_lading",
      "commercial_invoice"
    ],
    "dependencies": [
      "insurance_certificate"
    ],
    "description": "Certifies goods originate from Finland"
  },
  "packing_list": {
    "order": 8,
    "creator": "seller",
    "creator_name": "Seller (Nordic Timber)",
    "action": "Creates Packing List",
    "triggers": [
      "bill_of_lading"
    ],
    "dependencies": [
      "insurance_certificate"
    ],
    "description": "Details of 8 timber bundles, 28.8 tons total"
  },
  "bill_of_lading": {
    "order": 9,
    "creator": "carrier",
    "creator_name": "Carrier (FESCO)",
    "action": "Issues Bill of Lading",
    "triggers": [
      "commercial_invoice",
      "customs_declaration_export",
      "sea_cargo_manifest"
    ],
    "dependencies": [
      "certificate_of_origin",
      "packing_list"
    ],
    "description": "Ocean B/L for MV Baltic Express, Rauma ‚Üí Tokyo"
  },
  "commercial_invoice": {
    "order": 10,
    "creator": "seller",
    "creator_name": "Seller (Nordic Timber)",
    "action": "Issues Commercial Invoice",
    "triggers": [
      "customs_declaration_export"
    ],
    "dependencies": [
      "bill_of_lading"
    ],
    "description": "Invoice for EUR 339,000 (CFR terms)"
  },
  "customs_declaration_export": {
    "order": 11,
    "creator": "customs",
    "creator_name": "Customs (Finnish Customs)",
    "action": "Clears for Export",
    "triggers": [
      "sea_cargo_manifest"
    ],
    "dependencies": [
      "bill_of_lading",
      "commercial_invoice"
    ],
    "description": "Export declaration at Rauma Port customs"
  },
  "sea_cargo_manifest": {
    "order": 12,
    "creator": "carrier",
    "creator_name": "Carrier (FESCO)",
    "action": "Files Cargo Manifest",
    "triggers": [
      "payment_confirmation"
    ],
    "dependencies": [
      "customs_declaration_export",
      "bill_of_lading"
    ],
    "description": "Vessel manifest filed, cargo loaded and sailing"
  },
  "payment_confirmation": {
    "order": 13,
    "creator": "bank",
    "creator_name": "Bank (MUFG/Nordea)",
    "action": "Processes L/C Payment",
    "triggers": [
      "customs_declaration_import"
    ],
    "dependencies": [
      "sea_cargo_manifest"
    ],
    "description": "Documents presented, L/C payment released (EUR 339,000)"
  },
  "customs_declaration_import": {
    "order": 14,
    "creator": "customs",
    "creator_name": "Customs (Japanese Customs)",
    "action": "Clears for Import",
    "triggers": [
      "delivery_note"
    ],
    "dependencies": [
      "payment_confirmation"
    ],
    "description": "Import clearance at Tokyo Port (zero duty under EU-Japan EPA)"
  },
  "delivery_note": {
    "order": 15,
    "creator": "buyer",
    "creator_name": "Logistics (Tokyo Logistics)",
    "action": "Delivers to Construction Site",
    "triggers": [],
    "dependencies": [
      "customs_declaration_import"
    ],
    "description": "Final delivery to buyer's construction site warehouse"
  }
};

// Actor colors for visualization
const actorColors = {
  "buyer": "#3b82f6",
  "seller": "#10b981",
  "bank": "#f59e0b",
  "carrier": "#06b6d4",
  "customs": "#8b5cf6",
  "chamber": "#ec4899",
  "certifier": "#14b8a6"
};

// Process stages
const processStages = [
  {
    "name": "Negotiation & Contract",
    "docs": [
      "purchase_order",
      "documentary_credit"
    ],
    "description": "Buyer and seller agree on terms; bank provides payment guarantee"
  },
  {
    "name": "Preparation & Certification",
    "docs": [
      "regulatory_certificate",
      "warehouse_receipt",
      "phytosanitary_certificate",
      "insurance_certificate"
    ],
    "description": "Seller prepares goods, obtains required certificates and insurance"
  },
  {
    "name": "Documentation & Export",
    "docs": [
      "certificate_of_origin",
      "packing_list",
      "bill_of_lading",
      "commercial_invoice",
      "customs_declaration_export"
    ],
    "description": "Export documents prepared, customs clearance, goods loaded"
  },
  {
    "name": "Transit & Payment",
    "docs": [
      "sea_cargo_manifest",
      "payment_confirmation"
    ],
    "description": "Goods in transit, documents presented to bank, payment released"
  },
  {
    "name": "Import & Delivery",
    "docs": [
      "customs_declaration_import",
      "delivery_note"
    ],
    "description": "Import clearance at destination, final delivery to buyer"
  }
];

// Actor information
const actors = [
  { id: 'buyer', name: 'Buyer', icon: 'üè¢', description: 'Tokyo Construction Materials Ltd' },
  { id: 'seller', name: 'Seller', icon: 'üè≠', description: 'Nordic Timber Oy' },
  { id: 'bank', name: 'Bank', icon: 'üè¶', description: 'MUFG Tokyo / Nordea Finland' },
  { id: 'carrier', name: 'Carrier', icon: 'üö¢', description: 'FESCO Shipping' },
  { id: 'customs', name: 'Customs', icon: 'üõÉ', description: 'Finnish & Japanese Customs' },
  { id: 'chamber', name: 'Chamber', icon: 'üìú', description: 'Finnish Chamber of Commerce' },
  { id: 'certifier', name: 'Certifier', icon: '‚úÖ', description: 'T√úV S√úD & Food Authority' }
];

// Current state
let currentActor = 'buyer';
let currentDoc = null;
let flowAnimationStep = 0;
let flowAnimationInterval = null;

// Initialize demo
function initDemo() {
  renderActorTabs();
  renderDocuments(currentActor);
  renderTimeline();
  renderDocumentFlow();
}

// Render actor tabs
function renderActorTabs() {
  const container = document.getElementById('actor-tabs');
  if (!container) return;
  
  container.innerHTML = actors.map(actor => `
    <button class="actor-tab ${actor.id === currentActor ? 'active' : ''}"
            onclick="switchActor('${actor.id}')">
      <span class="actor-icon">${actor.icon}</span>
      <span class="actor-name">${actor.name}</span>
      <small>${actor.description}</small>
    </button>
  `).join('');
}

// Switch actor view
function switchActor(actorId) {
  currentActor = actorId;
  renderActorTabs();
  renderDocuments(actorId);
}

// Render documents for actor
function renderDocuments(actorId) {
  const container = document.getElementById('documents-grid');
  if (!container) return;
  
  const actorDocs = actorViews[actorId] || [];
  
  if (actorDocs.length === 0) {
    container.innerHTML = '<p class="no-docs">No documents for this actor</p>';
    return;
  }
  
  container.innerHTML = actorDocs.map(docKey => {
    const info = docInfo[docKey];
    const doc = documents[docKey];
    
    if (!info || !doc) return '';
    
    return `
      <div class="document-card" onclick="showDocument('${docKey}')">
        <div class="doc-icon">${info.icon}</div>
        <div class="doc-title">${info.title}</div>
        <div class="doc-description">${info.description}</div>
      </div>
    `;
  }).join('');
}

// Show document modal
function showDocument(docKey) {
  currentDoc = docKey;
  const info = docInfo[docKey];
  const doc = documents[docKey];
  
  if (!info || !doc) return;
  
  const modal = document.getElementById('doc-modal');
  const title = document.getElementById('doc-modal-title');
  const content = document.getElementById('doc-modal-content');
  
  title.innerHTML = `${info.icon} ${info.title}`;
  content.innerHTML = `<pre class="json-display">${syntaxHighlight(JSON.stringify(doc, null, 2))}</pre>`;
  
  modal.style.display = 'flex';
}

// Close modal
function closeModal() {
  document.getElementById('doc-modal').style.display = 'none';
  currentDoc = null;
}

// Syntax highlighting for JSON
function syntaxHighlight(json) {
  json = json.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
  return json.replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\\.\d*)?(?:[eE][+\\-]?\d+)?)/g, function (match) {
    let cls = 'json-number';
    if (/^"/.test(match)) {
      if (/:$/.test(match)) {
        cls = 'json-key';
      } else {
        cls = 'json-string';
      }
    } else if (/true|false/.test(match)) {
      cls = 'json-boolean';
    } else if (/null/.test(match)) {
      cls = 'json-null';
    }
    return '<span class="' + cls + '">' + match + '</span>';
  });
}

// Render timeline
function renderTimeline() {
  const container = document.getElementById('timeline-events');
  if (!container) return;
  
  container.innerHTML = timeline.map(event => `
    <div class="timeline-event ${event.doc ? 'clickable' : ''}" 
         ${event.doc ? `onclick="showDocument('${event.doc}')"` : ''}>
      <div class="timeline-date">${event.date}</div>
      <div class="timeline-marker"></div>
      <div class="timeline-content">
        <strong>${event.event}</strong>
        <small>${event.actor}</small>
      </div>
    </div>
  `).join('');
}

// Render document flow
function renderDocumentFlow() {
  const container = document.getElementById('flow-diagram');
  if (!container) return;
  
  // Get documents sorted by order
  const sortedDocs = Object.keys(documentFlow).sort((a, b) => 
    documentFlow[a].order - documentFlow[b].order
  );
  
  // Group by stage
  let html = '<div class="flow-stages">';
  
  processStages.forEach((stage, stageIdx) => {
    html += `
      <div class="flow-stage">
        <div class="stage-header">
          <div class="stage-number">${stageIdx + 1}</div>
          <div>
            <h3>${stage.name}</h3>
            <p>${stage.description}</p>
          </div>
        </div>
        <div class="stage-docs">
    `;
    
    stage.docs.forEach(docKey => {
      const flow = documentFlow[docKey];
      const info = docInfo[docKey];
      const color = actorColors[flow.creator];
      
      html += `
        <div class="flow-doc" 
             data-doc="${docKey}"
             data-order="${flow.order}"
             style="border-color: ${color};"
             onclick="showDocumentFlow('${docKey}')">
          <div class="flow-doc-header" style="background: ${color};">
            <div class="flow-doc-number">${flow.order}</div>
            <div class="flow-doc-icon">${info.icon}</div>
          </div>
          <div class="flow-doc-body">
            <div class="flow-doc-title">${info.title}</div>
            <div class="flow-doc-creator">${flow.creator_name}</div>
            <div class="flow-doc-action">${flow.action}</div>
          </div>
          ${flow.dependencies.length > 0 ? `
            <div class="flow-doc-deps">
              <small>Requires: ${flow.dependencies.length} doc(s)</small>
            </div>
          ` : ''}
          ${flow.triggers.length > 0 ? `
            <div class="flow-doc-triggers">
              <small>‚Üí Triggers: ${flow.triggers.length} doc(s)</small>
            </div>
          ` : ''}
        </div>
      `;
    });
    
    html += `
        </div>
      </div>
    `;
    
    // Add stage connector
    if (stageIdx < processStages.length - 1) {
      html += '<div class="stage-connector">‚Üí</div>';
    }
  });
  
  html += '</div>';
  
  container.innerHTML = html;
}

// Show document in flow context
function showDocumentFlow(docKey) {
  const flow = documentFlow[docKey];
  const info = docInfo[docKey];
  const doc = documents[docKey];
  
  if (!flow || !info || !doc) return;
  
  const modal = document.getElementById('doc-modal');
  const title = document.getElementById('doc-modal-title');
  const content = document.getElementById('doc-modal-content');
  
  let flowInfo = `
    <div class="flow-info">
      <h3>üìã Document Flow Information</h3>
      <div class="flow-info-grid">
        <div class="flow-info-item">
          <strong>Order:</strong> #${flow.order} of 15
        </div>
        <div class="flow-info-item">
          <strong>Creator:</strong> ${flow.creator_name}
        </div>
        <div class="flow-info-item">
          <strong>Action:</strong> ${flow.action}
        </div>
        <div class="flow-info-item">
          <strong>Description:</strong> ${flow.description}
        </div>
      </div>
  `;
  
  if (flow.dependencies.length > 0) {
    flowInfo += `
      <div class="flow-dependencies">
        <h4>üì• Requires These Documents First:</h4>
        <ul>
          ${flow.dependencies.map(dep => `
            <li onclick="showDocumentFlow('${dep}')" style="cursor: pointer; color: #3b82f6;">
              ${docInfo[dep].icon} ${docInfo[dep].title}
            </li>
          `).join('')}
        </ul>
      </div>
    `;
  }
  
  if (flow.triggers.length > 0) {
    flowInfo += `
      <div class="flow-triggers">
        <h4>üì§ Triggers Creation Of:</h4>
        <ul>
          ${flow.triggers.map(trig => `
            <li onclick="showDocumentFlow('${trig}')" style="cursor: pointer; color: #10b981;">
              ${docInfo[trig].icon} ${docInfo[trig].title}
            </li>
          `).join('')}
        </ul>
      </div>
    `;
  }
  
  flowInfo += '</div><hr>';
  
  title.innerHTML = `${info.icon} ${info.title} <span style="font-size: 0.6em; opacity: 0.8;">(#${flow.order})</span>`;
  content.innerHTML = flowInfo + `<pre class="json-display">${syntaxHighlight(JSON.stringify(doc, null, 2))}</pre>`;
  
  modal.style.display = 'flex';
}

// Close modal on escape
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && currentDoc) {
    closeModal();
  }
});

// Close modal on click outside
document.getElementById('doc-modal')?.addEventListener('click', (e) => {
  if (e.target.id === 'doc-modal') {
    closeModal();
  }
});

// Initialize when DOM is ready
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initDemo);
} else {
  initDemo();
}

</script>
    <script>
        // View switching
        function showView(viewName) {
            // Update nav tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Update view sections
            document.querySelectorAll('.view-section').forEach(section => {
                section.classList.remove('active');
            });
            document.getElementById(viewName + '-view').classList.add('active');
        }
    </script>
</body>
</html>
